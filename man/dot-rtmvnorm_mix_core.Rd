% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vpc_ci.R
\name{.rtmvnorm_mix_core}
\alias{.rtmvnorm_mix_core}
\title{Sample from a Truncated Multivariate Normal Mixture}
\usage{
.rtmvnorm_mix_core(
  mean,
  Sigma,
  pis,
  n = 10,
  truncated = TRUE,
  groups = list(),
  fill_excluded = 0
)
}
\arguments{
\item{mean}{Numeric vector of means for the multivariate normal distribution.}

\item{Sigma}{Positive-definite covariance matrix, with dimensions matching \code{mean}.}

\item{pis}{Numeric vector of mixture probabilities of length \eqn{2^q}, where \eqn{q}
is the number of groups. Must sum to 1 (or will be normalized).}

\item{n}{Integer, number of samples to generate. Default is 10.}

\item{truncated}{Logical, whether to truncate variables (default \code{TRUE}). If \code{TRUE},
variables matching \code{nonneg_prefix} are truncated below at 0.}

\item{groups}{Named list specifying groups of variable names. Each group defines
coordinates that may be excluded in different mixture components.}

\item{fill_excluded}{Value used to fill excluded variables (default \code{0}).}
}
\value{
A numeric matrix of dimension \eqn{n \times p}, where \eqn{p = length(mean)}.
Rows correspond to generated samples, and columns to variables. Excluded coordinates
are filled with \code{fill_excluded}.
}
\description{
This function generates random samples from a mixture of truncated multivariate normal
distributions. Mixture components are defined by group-wise exclusions of variables.
Each component is sampled according to mixture weights (\code{pis}) with optional truncation
to enforce non-negativity constraints on specified variables.
}
\examples{
set.seed(123)
mean  <- c(sig11 = 0, sig22 = 0, x3 = 1)
Sigma <- diag(3)
pis   <- c(0.5, 0.5)
groups <- list(g1 = "sig11")

.rtmvnorm_mix_core(mean, Sigma, pis, n = 5, groups = groups)

}
