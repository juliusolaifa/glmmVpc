% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vpc_ci.R
\name{rmixtnorm}
\alias{rmixtnorm}
\title{Generate random samples from a mixture of (optionally truncated) multivariate normals}
\usage{
rmixtnorm(mean, Sigma, pis, n = 10, truncated = TRUE)
}
\arguments{
\item{mean}{A numeric vector of means for each dimension. The names of \code{mean} are used
to determine which dimensions potentially get truncated (\code{"sig11"} or \code{"sig22"}).}

\item{Sigma}{A covariance matrix for the underlying multivariate normal distribution.}

\item{pis}{A numeric vector of mixture proportions. Must sum up to \code{1}, and must have
length up to \code{4} to match the four possible components in the mixture.}

\item{n}{An integer specifying the number of random draws to generate.}

\item{truncated}{A logical flag. If \code{TRUE}, samples for certain components
are drawn from a truncated multivariate normal using \pkg{tmvtnorm}; if \code{FALSE},
the function uses \pkg{mvtnorm} without truncation for those components.}
}
\value{
A matrix with \code{n} rows and \code{length(mean)} columns, where each row is
one random draw from the specified mixture distribution.
}
\description{
This function generates \code{n} random draws from a mixture of up to four different
(truncated or non-truncated) multivariate normal components, determined by
\code{pis}. The function internally checks for entries named \code{"sig11"} or
\code{"sig22"} in \code{mean} to decide how to truncate each component.
}
\details{
The function does the following for each draw:
\enumerate{
\item Draws a uniform random number \code{u}.
\item Checks which mixture component \code{u} falls into (based on \code{pis}).
\item Depending on the component, it selects which subset of dimensions to truncate at 0
(if \code{truncated=TRUE}) or sample normally:
\itemize{
\item Component 1: No truncation; draw from \code{mvtnorm::rmvnorm(1, Sigma)}.
\item Component 2: Truncate dimensions \emph{not} labeled \code{"sig11"}.
\item Component 3: Truncate dimensions \emph{not} labeled \code{"sig22"}.
\item Component 4: Neither \code{"sig11"} nor \code{"sig22"} dimensions are truncated.
}
}
}
\examples{
\dontrun{
set.seed(123)

# Example: Suppose we have two dimensions, named "sig11" and "otherDim".
# We'll draw from a mixture with two components (50/50) where
#   - First component: standard MVN(0, I)
#   - Second component: truncated in dimension "otherDim" >= 0

my_mean  <- c(sig11 = 0, otherDim = 0)
my_Sigma <- diag(2)
my_pis   <- c(0.5, 0.5)  # two-component mixture

samples <- rmixtnorm(mean = my_mean, Sigma = my_Sigma, pis = my_pis,
                     n = 1000, truncated = TRUE)
head(samples)
}

}
